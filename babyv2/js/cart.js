function ajax_loading(e){0==$("#bg-load").length&&$("body").append('<div id="bg-load"><div class="loader"></div></div>'),e?$("#bg-load").show():$("#bg-load").hide()}function update_point_fshare(e){var a,r="";a=$("#sum_point").val()-e,r=String(a).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"),r+=" VNÄ",$("#sum_all_point").val(r)}function update_coupon(e){$("#coupon_code").parent().find(".has-error").remove();var a=$("#coupon_code").attr("data-price"),r=/^[+-]?\d+(\.\d+)?([eE][+-]?\d+)?$/,o=$("#number").val();r.test(o)||(o=1);var n=0,s="";if(!e&&a)n=$("#sum").val()-a*o,s=String(n).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"),s+=" VNĐ",$("#sum_all").val(s),r=String(a*o).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"),$("#coupon_discount").val(r+" VNĐ");else{var i=$("#coupon_code").val();if(i){ajax_loading(!0);var c=0<$("#giftcode_serial").length?$("#giftcode_serial").val():"";$.get("/welcome/check-price-gift-code",{gift_code:i,serial:c},function(e){$("#coupon_code_fshare").attr("data-price",e.price),n=$("#sum").val()-e.price*o,s=String(n).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"),$("#sum_all").val(s+" VNĐ"),r=String(e.price*o).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"),$("#coupon_discount").val(r+" VNĐ"),0==e.rs&&$("#coupon_code").parent().append('<label style="display: block" class="has-error">'+e.msg+"</label>"),ajax_loading(!1)},"json")}else $("#coupon_code").attr("data-price",0),n=$("#sum").val(),s=String(n).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"),$("#sum_all").val(s+" VNĐ"),$("#coupon_discount").val("0 VNĐ")}}function update_coupon_fshare(e){$("#coupon_code_fshare").parent().find(".has-error").remove();var r=/^[+-]?\d+(\.\d+)?([eE][+-]?\d+)?$/,o=$("#number").val(),n=$("#number1").val();r.test(o)||(o=1);var s=0,i="",c=0,l="",t=0,a=$("#coupon_code_fshare").val(),d=0<$("#giftcode_serial").length?$("#giftcode_serial").val():"";$.ajax({url:"/welcome/check-price-gift-code",type:"POST",data:{gift_code:a,serial:d},beforeSend:function(){ajax_loading(!0)},success:function(e){ajax_loading(!1);var a=JSON.parse(e);if(0==a.rs)$("#coupon_code_fshare").parent().append('<label style="display: block" class="has-error">'+a.msg+"</label>");else{$("#coupon_code_fshare").attr("data-price");$("#coupon_code_fshare").attr("data-price",a.price),t=$("#pay_is_money").is(":checked")?o:n,r=String(a.price*t).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"),$("#coupon_discount_fshare").val(r+" VNĐ"),s=$("#sum").val()-a.price*o,i=String(s).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"),$("#sum_all").val(i+" VNĐ"),c=$("#price_point").val()*n-a.price*n,l=String(c).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"),$("#sum_all_point").val(l+" VNĐ")}}})}$(document).on("change","#number",function(){var e=$(this).val(),a=$("#price").val();if((o=parseInt($(this).val()))<0)alert("Số lượng phải lớn hơn 0 !");else if(null!=$("#coupon_code_fshare").attr("data-price")){var r=$("#coupon_code_fshare").attr("data-price");tmp=String(r*o).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"),$("#coupon_discount_fshare").val(tmp+" VNĐ")}else{/^[+-]?\d+(\.\d+)?([eE][+-]?\d+)?$/.test(e)?a*=parseInt($(this).val()):$("#number").val("1");var o=String(a).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,");$("#sum").val(a),o+=" VNĐ",$("#sum_all").val(o),update_coupon(!1)}}),$(document).on("change","#coupon_code",function(){update_coupon(!0)}),$(document).on("change","#coupon_code_fshare",function(){update_coupon_fshare(!0)});var fixKeyword=function(e){return e=(e=(e=(e=e.toLowerCase()).replace(/[^\s0-9a-zA-ZấầẩẫậẤẦẨẪẬắằẳẵặẮẰẲẴẶáàảãạâăÁÀẢÃẠÂĂếềểễệẾỀỂỄỆéèẻẽẹêÉÈẺẼẸÊíìỉĩịÍÌỈĨỊốồổỗộỐỒỔÔỘớờởỡợỚỜỞỠỢóòỏõọôơÓÒỎÕỌÔƠứừửữựỨỪỬỮỰúùủũụưÚÙỦŨỤƯýỳỷỹỵÝỲỶỸỴđĐ]+/g," ")).replace(/^\s+|\s+$/g,"")).replace(/\s{1,}/g,"+")};$("#search2").submit(function(){var e=$(this).find("input[name=keyword]")[0];if(void 0!==e&&null!=e){var a=$(e).val();if(a=fixKeyword(a),""==(a=$.trim(a)))return $(e).focus(),!1;window.location.replace("/tim-kiem/"+a+"/")}return!1}),$("#search").submit(function(){var e=$(this).find("input[name=keyword]")[0];if(void 0!==e&&null!=e){var a=$(e).val();if(a=fixKeyword(a),""==(a=$.trim(a)))return $(e).focus(),!1;window.location.replace("/tim-kiem/"+a+"/")}return!1}),$("a.search-submit2").click(function(){var e=$("#search2").find("input[name=keyword]")[0];if(void 0!==e&&null!=e){var a=$(e).val();if(a=fixKeyword(a),""==(a=$.trim(a)))return $(e).focus(),!1;window.location.replace("/tim-kiem/"+a+"/")}return!1}),$("a.search-submit").click(function(){var e=$("#search").find("input[name=keyword]")[0];if(void 0!==e&&null!=e){var a=$(e).val();if(a=fixKeyword(a),""==(a=$.trim(a)))return $(e).focus(),!1;window.location.replace("/tim-kiem/"+a+"/")}return!1});var $searchlink=$("#searchlink");$searchlink.on("click",function(e){var a=e?e.target:window.event.srcElement;"searchlink"==$(a).attr("id")&&($(this).hasClass("open")?($(this).removeClass("open"),$("#searchlink").hasClass("fa-search"),$("#searchlink").removeClass("fa-remove")):($(this).addClass("open"),$("#searchlink").addClass("fa-remove")))});var $formsearch=$("#form-search"),$formse=$(".searchform");$formsearch.on("click",function(e){$formse.animate("slow");var a=e?e.target:window.event.srcElement;"form-search"==$(a).attr("id")&&($(this).hasClass("open")?($(this).removeClass("open"),$("#form-search").hasClass("fa-search"),$("#form-search").removeClass("fa-remove")):($(this).addClass("open"),$("#form-search").addClass("fa-remove"),$("#navbar").removeClass("in"),$("#navheader").removeClass("fa-remove")))});var $navheader=$("#navheader");$navheader.on("click",function(e){var a=e?e.target:window.event.srcElement;"navheader"==$(a).attr("id")&&($(this).hasClass("open")?($(this).removeClass("open"),$("#navheader").hasClass("fa-reorder"),$("#navheader").removeClass("fa-remove")):($(this).addClass("open"),$("#navheader").addClass("fa-remove")),$("#form-search").removeClass("open fa-remove"))}),$(document).ready(function(){});